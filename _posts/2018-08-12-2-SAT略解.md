---
layout:     post
title:      "2-SAT略解"
date:       2018-08-12
author:     "Dispwnl"
header-img: "img/used/6666.jpg"
catalog: true
tags:
    - 2-SAT
---
>竟然没有2-SAT的百度词条_(:з」∠)_

2-SAT是一种特殊的逻辑判定问题

emmmm先看一道题：
>众所周知，Aufun有很多的Au~~不然怎么叫Aufun~~

>Aufun每天最大的乐趣就是把这些Au翻过来翻过去

>现在你已经知道m条关于这些Au的信息，每条信息告诉你标号为X Au正/反的时候标号为Y 的Au不能为正/反

>Aufun想问问你是否有一种情况ta 的Au满足这些条件，并让你随便构造出一种来

~~正解：以大量纸片人为交换代价让Aufun代你A这道题~~

- ## 构造状态

发现每块Au（点）都有两种状态（正/反）

我们想到每个点可以拆开成两个点，分别代表着一种状态，x0表示这个点状态为反，x1表示这个点状态为正

emmmm有点了，我们可不可以通过连边来表示点与点之间的关系呢？

如果选了点A就必须选点B，就从A出发连一条单向边到B

这样两种状态之间，A正面B必须反面就可以表示成A0->B1

![](/img/study/2-sat.png)

如图，如果按照刚才的方法连边，应该是A正面B反面，B反面C反面，C反面C正面，C正面B正面，A反面D正面，D反面B正面

等等C反面C正面是什么鬼？

就是C反面C就必须正面，这样的事情根本不可能~~你给我搞一个试试~~，所以C必须正面

- ## 判断方案是否可行

发现点与点之间是单向边，那么我们连着连着就可能出现强连通分量

有什么影响吗？

![](/img/study/2-sat1.png)

这样构成的一张图，可以看出B0,C0,C1,D1在一个强连通分量中，在一个强连通分量说明选了其中一个点其他在同一强连通分量中的点都必须选

这样选C0就必须选C1，选C1也必须选C0，这肯定不成立QAQ

所以我们可以通过找强连通分量来判断是否存在可行方案

复杂度：O(m)（m为连边数量）

- ## 输出方案

因为A连B表示选A必须选B，所以A的拓扑序肯定大于B

注意这里是选A就必须选B，但是选B不一定选A

所以对于每个点的两种状态，可以选拓扑序大的，舍弃掉另一个（选一个就不能选另一个了）

每个点都判断与对立点谁的拓扑序大

注意这里可以不用再搞一遍拓扑排序，因为tarjan求强连通分量每个点所在的强连通分量编号可以代替拓扑序

编号和拓扑序是相反的，即要每两对点找编号小的

输出每个点状态就行了

- ## 其他情况

两个点的关系还有很多，列举几个（这里存在和不存在是一个点的两种状态）：

A和B不能同时存在：A->B',B->A'

A和B必须同时存在：A->B,A'->B'

A和B必须存在其中一个：A'->B,B'->A

A和B不能同时存在：A->B',B->A'

A不能存在：A->A'

- ## 输出方案 二连击

上面的输出方案是随意输出一种即可，但是要是要求输出字典序最小的答案呢？

也是很好解决的，dfs即可

点从1~2*n枚举，如果这个点能选，就将ta相连的点都选上，就将ta相连的点的相连的点都选上，就将。。。如果某个点发生冲突了（对立点被选了），这个点就不能选，与ta相连的点不能选，与ta相连的点的相连点不能选，与ta。。。这样最后被选中的点就是这字典序最小的解了

~~发现我大部分在水字数啊emmmm~~

几道例题：

[真·模板题](https://www.luogu.org/problemnew/show/P4782)

[将3个状态转成2个状态](https://www.luogu.org/problemnew/show/P3825)

[处理必须选的、必须不选的、可选可不选的](http://hzwer.com/5711.html)
